"use strict";(()=>{var e={};e.id=848,e.ids=[848],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5315:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>b,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>c,staticGenerationAsyncStorage:()=>l});var o={};t.r(o),t.d(o,{POST:()=>u});var n=t(9303),s=t(8716),a=t(670),i=t(7070);async function u(e){let r=function(e){let r=e.headers.get("x-bbox-fid");if(!r)return null;let t=Number(r);return Number.isFinite(t)?t:null}(e);if(!r)return i.NextResponse.json({error:"Missing FID (x-bbox-fid header)"},{status:401});let{txHash:t}=await e.json();if(!t)return i.NextResponse.json({error:"Missing txHash"},{status:400});await Object(function(){var e=Error("Cannot find module '@/lib/user'");throw e.code="MODULE_NOT_FOUND",e}())(r);let{error:o}=await Object(function(){var e=Error("Cannot find module '@/lib/supabaseServer'");throw e.code="MODULE_NOT_FOUND",e}()).from("users").update({is_og:!0}).eq("fid",r);if(o)return console.error("OG update error",o),i.NextResponse.json({error:"Failed to set OG"},{status:500});let{error:n}=await Object(function(){var e=Error("Cannot find module '@/lib/supabaseServer'");throw e.code="MODULE_NOT_FOUND",e}()).from("payments").insert({fid:r,type:"og",pack_size:null,eth_amount:process.env.BBOX_OG_PRICE_ETH||null,tx_hash:t,status:"confirmed"});return n&&console.error("OG payment insert error",n),i.NextResponse.json({success:!0})}(function(){var e=Error("Cannot find module '@/lib/supabaseServer'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/user'");throw e.code="MODULE_NOT_FOUND",e}();let p=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/buy/og/route",pathname:"/api/buy/og",filename:"route",bundlePath:"app/api/buy/og/route"},resolvedPagePath:"/workspaces/bbox/src/app/api/buy/og/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:c}=p,b="/api/buy/og/route";function f(){return(0,a.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:l})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(5315));module.exports=o})();